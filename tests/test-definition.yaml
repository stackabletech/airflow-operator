#
# These tests can run against an OpenShift cluster, provided you perform the following
# steps manually before starting them with scripts/run_tests.sh
#
# 1. Set the "openshift" dimension below to "true" (with quotes)
---
dimensions:
  - name: airflow
    values:
      - 2.2.4-stackable23.7
      - 2.2.5-stackable23.7
      - 2.4.1-stackable23.7
      - 2.6.1-stackable23.7
  - name: airflow-latest
    values:
      - 2.6.1-stackable23.7
  - name: ldap-authentication
    values:
      - no-tls
      - insecure-tls
      - server-verification-tls
  - name: openshift
    values:
      - "false"
tests:
  - name: smoke
    dimensions:
      - airflow
      - openshift
  - name: mount-dags-configmap
    dimensions:
      - airflow-latest
      - openshift
  - name: mount-dags-gitsync
    dimensions:
      - airflow-latest
      - openshift
  - name: ldap
    dimensions:
      - airflow-latest
      - openshift
      - ldap-authentication
  - name: resources
    dimensions:
      - airflow-latest
      - openshift
  - name: orphaned-resources
    dimensions:
      - airflow-latest
      - openshift
  - name: logging
    dimensions:
      - airflow
      - openshift
  - name: cluster-operation
    dimensions:
      - airflow-latest
      - openshift
suites:
  - name: nightly
    # Run nightly with the latest airflow
    patch:
      - dimensions:
          - name: airflow
            expr: last
  - name: smoke-latest
    # Useful for development
    select:
      - smoke
    patch:
      - dimensions:
          - expr: last
  - name: openshift
    # Run on OpenShift with latest airflow
    patch:
      - dimensions:
          - expr: last
      - dimensions:
          - name: airflow
            expr: last
          - name: openshift
            expr: "true"
